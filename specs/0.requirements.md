# Requirements for ps-mem

## Functional Requirements

The `ps-mem` command-line tool provides detailed memory usage information for processes on a Linux system.

1.  **Process Memory Listing**:
    *   The tool shall list memory usage for currently running processes.
    *   By default, it should display PID, RSS, Swap, and Total memory usage, along with the process command.

2.  **Filtering and Selection**:
    *   The user shall be able to view memory usage for a single process by specifying its Process ID (PID) using the `--pid` option.
    *   The user shall be able to include all processes, including kernel threads, using the `-a` or `--all` flag.

3.  **Sorting**:
    *   The output shall be sortable based on different memory metrics.
    *   Supported sort orders are:
        *   `rss`: Resident Set Size
        *   `swap`: Swapped-out memory
        *   `total`: Total memory (RSS + Swap)
    *   The sort order can be specified using the `--sort` option.

4.  **Command Execution and Monitoring**:
    *   The tool shall be able to execute a given command and monitor its memory consumption from launch until termination.
    *   The user can specify a command to run directly after the `ps-mem` options.

5.  **Output Formatting**:
    *   Memory sizes shall be displayed in a human-readable format (e.g., KiB).
    *   The user shall be able to view the full command line for each process using the `-l` or `--cmdline` flag.
    *   The tool shall provide a summary row showing the total memory consumed.

6.  **Configuration and Help**:
    *   The tool shall provide a help message detailing its usage and options via the `-H` or `--help` flags.
    *   The tool shall display its version information via the `-V` or `--version` flags.
    *   Advanced and debugging options shall be available under the `-X` flag.

## Non-Functional Requirements / Dependencies

The tool is built in Rust and relies on the following external crates:

*   **`anyhow`**: For flexible and easy-to-use error handling.
*   **`flood-tide`**: For parsing command-line arguments in the GNU style.
*   **`runnel`**: For managing input/output streams (stdin, stdout, stderr).
*   **`memx-cdy`**: Provides optimized memory operations.
*   **`num-format`**: For formatting numbers with separators (e.g., thousands commas) to improve readability.
*   **`signal-hook`**: To handle process signals gracefully, such as `SIGINT` (Ctrl+C) during command execution monitoring.
*   **`linux-procfs`**: To interface with the Linux `/proc` filesystem for gathering detailed process information, including memory usage and command lines.
